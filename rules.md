# 项目编码规则

## 核心原则

本项目采用函数式编程风格，所有代码必须遵循以下规则：

### 1. 函数式风格
- **不使用 class**：所有逻辑都通过纯函数实现
- **不使用 interface**：使用 type 定义类型
- **纯函数优先**：函数不应有副作用，除非明确需要

### 2. 函数大小限制
- **每个函数不超过 20 行**
- 大函数必须拆分为多个小函数
- 通过组合小函数来实现复杂逻辑

### 3. 文件大小限制
- **每个文件不超过 200 行**
- 大文件必须拆分为多个小文件
- 每个文件保持单一职责

### 4. 文件职责原则
- **每个文件最多只 export 一个函数**，types 不限
- 每个文件必须有明确的单一职责
- 文件名应该清晰反映其职责

### 5. 文件夹结构规范

#### 单模块文件夹 (Single Module Folder)
- **必须包含 `index.ts`**
- **单一职责**：`index.ts` 中只 export 一个函数
- 示例：`loader/` - 负责加载 OpenAPI 文档

#### 多模块文件夹 (Multi Module Folder)
- **没有 `index.ts`**
- 只是对多个相似类型模块的聚类
- 示例：`generators/` - 包含各种代码生成器

### 6. 导入规范
- **禁止显示导入 `index.ts`**
- 应该直接导入具体的文件：`import { func } from './impl'`
- 保持导入路径清晰和明确

### 7. 文件夹文档
- **每个文件夹必须有 `README.md`**
- 单模块文件夹：说明职责
- 多模块文件夹：说明模块共同点

### 8. 文件布局规范
每个文件必须遵循统一的布局：

```typescript
// 文件顶部职责说明注释
/**
 * 此文件的职责是什么
 */

// imports 部分
import statements...

// types 部分
type definitions...

// export function (只有一个)
export function mainFunction(...) {
  // 函数实现
}

// internal functions (如果需要)
function helperFunction(...) {
  // 辅助函数实现
}
```

### 9. 文件职责说明
- **每个文件顶部必须有职责说明注释**
- 使用 `/** */` 格式
- 格式要求：
  - 输出函数名
  - 函数的签名
  - 输入参数代表什么
  - 输出结果代表什么

## 代码审查清单

提交代码前请检查：

- [ ] 是否使用了 class 或 interface？
- [ ] 每个函数是否超过 20 行？
- [ ] 每个文件是否超过 200 行？
- [ ] 文件是否只 export 一个函数？
- [ ] 文件夹结构是否正确（单模块 vs 多模块）？
- [ ] 是否直接导入了 index.ts？
- [ ] 每个文件夹是否有 README.md？
- [ ] 文件布局是否符合规范？
- [ ] 文件顶部是否有职责说明？

## 重构指南

### 函数拆分技巧
1. **提取纯函数**：将复杂逻辑提取为独立的纯函数
2. **参数传递**：通过参数传递数据，避免闭包
3. **组合函数**：使用函数组合来构建复杂行为

### 文件拆分技巧
1. **职责分离**：每个文件只做一件事
2. **类型分离**：将类型定义移到单独的文件
3. **工具函数**：将通用工具函数提取到 utils 文件

### 文件夹重构
1. **识别职责**：确定文件夹是单模块还是多模块
2. **创建索引**：单模块文件夹需要 index.ts
3. **文档化**：为每个文件夹创建 README.md
